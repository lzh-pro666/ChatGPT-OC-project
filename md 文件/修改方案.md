我看了一下你这份 `AttachmentScrollNode.m`，导致 **图片显示区域过小** 的原因主要有以下几个问题点：

---

### 1. 你把 `ASImageNode/ASNetworkImageNode` 替换成了 `ASButtonNode`

* `ASButtonNode` 的 `imageNode` 默认 **内容模式是 `scaleAspectFit`**，即便你设置了 `buttonNode.contentMode = UIViewContentModeScaleAspectFill;`，对内部的 `imageNode` 不起作用。
* 所以图片实际显示会被缩小，而不是填满 `imageSize`。

👉 修复方式：
在创建按钮时要明确设置 **内部的 `imageNode` 的 contentMode**：

```objc
buttonNode.imageNode.contentMode = UIViewContentModeScaleAspectFill;
buttonNode.imageNode.clipsToBounds = YES;
```

而不是只对 `buttonNode` 本身设置。

---

### 2. 设置了 min/maxWidth/Height，可能导致约束冲突

你在 `createImageNodeForAttachment:` 里加了：

```objc
buttonNode.style.minWidth  = ASDimensionMake(self.imageSize);
buttonNode.style.minHeight = ASDimensionMake(self.imageSize);
buttonNode.style.maxWidth  = ASDimensionMake(self.imageSize);
buttonNode.style.maxHeight = ASDimensionMake(self.imageSize);
```

这等于强行把宽高锁死为 `imageSize`，**但 AsyncDisplayKit 布局时 stackSpec 已经提供了大小信息**，这会让系统在布局时缩放受限，可能显示异常。

👉 修复方式：
只保留

```objc
buttonNode.style.width  = ASDimensionMake(self.imageSize);
buttonNode.style.height = ASDimensionMake(self.imageSize);
```

就足够了。

---

### 3. `scrollNode.layoutSpecBlock` 和外层 `layoutSpecThatFits` 计算逻辑重复，容易尺寸不一致

在 `setupScrollView` 里你定义了：

```objc
self.scrollNode.layoutSpecBlock = ...
```

同时又在 `layoutSpecThatFits:` 里重新计算 scrollNode 和 contentNode 的宽度。
这两个地方可能计算出的宽度不一致，最终导致图片区域被压缩。

👉 修复方式：
**只保留一个计算逻辑**，推荐保留 `layoutSpecThatFits:`，移除 `scrollNode.layoutSpecBlock`，让 `scrollNode` 只作为容器。

---

### 4. 额外 `extraMargin = 10.0` 可能导致内容大小偏小/对齐错误

你在计算内容宽度时加了：

```objc
CGFloat extraMargin = 10.0;
totalContentWidth += extraMargin;
```

这个“补丁式”的 margin 会让布局不精准，尤其在 stackSpec 中本来 spacing 已经算过。
👉 修复方式：
去掉 `extraMargin`，直接使用：

```objc
CGFloat totalContentWidth = self.attachments.count * self.imageSize
                          + (self.attachments.count - 1) * self.imageSpacing;
```

---

✅ **总结建议修复方案：**

1. 不要用 `ASButtonNode` 包裹 `ASImageNode/ASNetworkImageNode`，除非你真的需要按钮特性；点击事件可以直接在 `ASImageNode/ASNetworkImageNode` 上添加 target。
2. 如果必须用 `ASButtonNode`，记得设置 `buttonNode.imageNode.contentMode = UIViewContentModeScaleAspectFill;`，并移除 `min/maxWidth/Height`。
3. 移除 `scrollNode.layoutSpecBlock`，只在 `layoutSpecThatFits:` 里控制尺寸。
4. 去掉额外的 `extraMargin`，避免误差。

---

要不要我帮你改一份 **精简版修复后的 `AttachmentScrollNode`**，保证既能点击又能正确显示大小？
